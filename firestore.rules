rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Admin biometric credentials - only accessible by server-side functions
    match /admin/{document=**} {
      allow read, write: if false; // Only Cloud Functions can access
    }

    // Auth challenges - only accessible by server-side functions
    match /auth_challenges/{document=**} {
      allow read, write: if false; // Only Cloud Functions can access
    }

    // Games collection - read by anyone, write only by authenticated admin
    match /games/{gameId} {
      allow read: if true;
      allow write: if request.auth != null &&
                      request.auth.uid == 'seZ01FolJbSajEKTIsljwGtYHGD3' &&
                      request.auth.token.adminAuthenticated == true;
    }

    // Teams collection - read by anyone, write only by authenticated admin
    match /teams/{teamId} {
      allow read: if true;
      allow write: if request.auth != null &&
                      request.auth.uid == 'seZ01FolJbSajEKTIsljwGtYHGD3' &&
                      request.auth.token.adminAuthenticated == true;
    }

    // Bracket collection - read by anyone, write only by authenticated admin
    match /bracket/{bracketId} {
      allow read: if true;
      allow write: if request.auth != null &&
                      request.auth.uid == 'seZ01FolJbSajEKTIsljwGtYHGD3' &&
                      request.auth.token.adminAuthenticated == true;
    }

    // Contact messages - anyone can create, only admin can read
    match /contact_messages/{messageId} {
      allow create: if true;
      allow read, update, delete: if request.auth != null &&
                                      request.auth.uid == 'seZ01FolJbSajEKTIsljwGtYHGD3' &&
                                      request.auth.token.adminAuthenticated == true;
    }
  }
}
